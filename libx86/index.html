<!DOCTYPE html>
<html>
<head>
<title>中控商品展示</title>
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="cache-control" content="no-cache">
<meta http-equiv="expires" content="0">
<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
<meta http-equiv="description" content="This is my page">
<script type="text/javascript" src="./jquery.js"></script>
<style type="text/css">
.search_input{  
	background-color: #f3f5f0;
    border: 1px solid #7ac143;
    border-radius: 60px;
    height: 30px;
    padding: 2px 8px 0 3px;
    width: 200px;
}
.search_button {
	background:url(./image/search.png);
}
.text {font-size: 18px; color: #7AC143; font-family: "微软雅黑";}
.form_text {font-family: "微软雅黑"}
.table_head {font-size: 14px}


.form_textfield{  
	padding:2px 8px 0pt 3px;
	width:300px;  
	height:100px; 
	border:1px solid #c3c2c2;
	border-radius:3px;  
	background-color:#f3f5f0;  
} 

.form_input{  
	padding:2px 8px 0pt 3px;
	width:300px;  
	height:34px; 
	border:1px solid #c3c2c2;
	border-radius:3px;  
	background-color:#f3f5f0;  
} 
.button { 
    font-family: "Arail", "微软雅黑"; 
    font-size: 12pt; color: #ffffff; 
    border: 0px #93bee2 solid; 
    background-image:url(<img src="./imege/button-常态.png" />); 
    background-color: #7AC143; 
	width:120px;
	height:34px;
	border-radius:3px;
    CURSOR: hand; 
    font-style: normal ; 
} 
.list_table td{
	border-bottom: 1px solid black;
}
</style>
</head>
<body style="margin-left: 10px">
<OBJECT ID="CertCtl"  name="CertCtl" CLASSID="CLSID:10946843-7507-44FE-ACE8-2B3483D179B7" width="0" height="0"></OBJECT>
<div align="left" class="text">中控科技二代身份证阅读程序</div><br>

<div>
		<table width="1200" height="423" border="0" cellpadding="0"	cellspacing="0">
			<tbody>
				<tr>
					<td height="58"><div align="left" class="form_text">操作结果：</div></td>
					<td><input type="text" name="result" class="form_input" id="idResult"></td>
					<td height="58"><div align="left" class="form_text">描述：</div></td>
					<td><input type="text" name="resultDesc" class="form_input" id="idResultDesc"></td>
				</tr>
				<tr>
					<td height="58"><div align="left" class="form_text">姓名：</div></td>
					<td><input type="text" name="Name" class="form_input" id="idName"></td>
					<td height="58"><div align="left" class="form_text">性别：</div></td>
					<td><input type="text" name="Sex" class="form_input" id="idSex"></td>
				</tr>
				<tr>
					<td height="58"><div align="left" class="form_text">民族&国家：</div></td>
					<td><input type="text" name="Nation" class="form_input" id="idNation"></td>
					<td height="58"><div align="left" class="form_text">出生日期：</div></td>
					<td><input type="text" name="Birthday" class="form_input" id="idBirthday"></td>
				</tr>
				<tr>
					<td height="58"><div align="left" class="form_text">家庭地址：</div></td>
					<td><input type="text" name="CertAddr" class="form_input" id="idCertAddr"></td>
					<td height="58"><div align="left" class="form_text">身份证号：</div></td>
					<td><input type="text" name="CertNbr" class="form_input" id="idCertNbr"></td>
				</tr>
				<tr>
					<td height="58"><div align="left" class="form_text">签发机关：</div></td>
					<td><input type="text" name="dsaf" class="form_input" id="idCertDep"></td>
					<td height="58"><div align="left" class="form_text">有效期起始时间：</div></td>
					<td><input type="text" name="textfdsafwfield" class="form_input" id="idCertEffDate"></td>
				</tr>
				<tr>
					<td height="58"><div align="left" class="form_text">有效期截止时间：</div></td>
					<td><input type="text" name="tew3erewxtfield" class="form_input" id="idCertExpDate"></td>
					<td height="58"><div align="left" class="form_text" ></div></td>
					<td></td>
				</tr>
				<tr>
					<td height="58"><div align="left" class="form_text">通信证号码：</div></td>
					<td><input type="text" name="VisaNo" class="form_input" id="idVisaNo"></td>
					<td height="58"><div align="left" class="form_text">签发次数：</div></td>
					<td><input type="text" name="VisaNum" class="form_input" id="idVisaNum"></td>
				</tr>
				<tr>
					<td height="58"><div align="left" class="form_text">中文名：</div></td>
					<td><input type="text" name="CnName" class="form_input" id="idCnName"></td>
					<td height="58"><div align="left" class="form_text">英文名：</div></td>
					<td><input type="text" name="EnName" class="form_input" id="idEnName"></td>
				</tr>
			</tbody>
		</table>
	</div>
	<input type="submit" name="Submit1" value="读卡" class="button" onclick="ReadCard()">
	<!--<input type="submit" name="Submit1" value="获取身份证正反两面图片(水平)" class="button" onclick="readCardImageH()">
	<input type="submit" name="Submit1" value="获取身份证正反两面图片(垂直)" class="button" onclick="readCardImageV()">
	<input type="submit" name="Submit1" value="获取身份证正面图片" class="button" onclick="readCardImageF()">
	<input type="submit" name="Submit1" value="获取身份证反面图片" class="button" onclick="readCardImageB()">-->
	<input type="submit" name="Submit1" value="读取指纹1" class="button" onclick="readFPData1()">
	<input type="submit" name="Submit1" value="读取指纹2" class="button" onclick="readFPData2()">
</body>
<script type="text/javascript">

function ClearData()
{
	document.getElementById("idResult").value = "";
    document.getElementById("idResultDesc").value = "";
	document.getElementById("idName").value = "";
    document.getElementById("idSex").value = "";
    document.getElementById("idNation").value = "";
    document.getElementById("idBirthday").value = "";
    document.getElementById("idCertAddr").value = "";
    document.getElementById("idCertNbr").value = "";
    document.getElementById("idCertDep").value = "";
    document.getElementById("idCertEffDate").value = "";
    document.getElementById("idCertExpDate").value = "";
    document.getElementById("idVisaNo").value = "";
    document.getElementById("idVisaNum").value = "";
}

function readCardImageH()
{
	if(1 == CertCtl.ExportJPGCardH())
	{
		alert(CertCtl.GetJPGCardHBase64());
	}
	else
	{
		alert("解析横板身份证正反两面图片失败");
	}
}

function readCardImageV()
{
	if(1 == CertCtl.ExportJPGCardV())
	{
		alert(CertCtl.GetJPGCardVBase64());
	}
	else
	{
		alert("解析竖板身份证正反两面图片失败");
	}
}

function readCardImageF()
{
	if(1 == CertCtl.ExportJPGCardF())
	{
		alert(CertCtl.GetJPGCardFBase64());
	}
	else
	{
		alert("解析横板身份证正面图片失败");
	}
}

function readCardImageB()
{
	if(1 == CertCtl.ExportJPGCardB())
	{
		alert(CertCtl.GetJPGCardBBase64());
	}
	else
	{
		alert("解析横板身份证反面图片失败");
	}
}

function readFPData1()
{
	
	alert(CertCtl.getFirstFPDataBase64());
}

function readFPData2()
{
	
	alert(CertCtl.getSecondFPDataBase64());
}

function ReadCard()
{	
	ClearData();
	 var result=CertCtl.ReadCard();
     if (result == "0")
     {
     	//alert(CertCtl.Picture);
     	//alert(CertCtl.CardReaderId);
     	//alert(CertCtl.SAMId);
     	//alert(CertCtl.PictureBmp);
     	//alert(CertCtl.IsRepeat);
     	//alert(CertCtl.pic);
     	//alert(CertCtl.CardType);

     	     	
			document.getElementById("idResult").value = "true";
			document.getElementById("idResultDesc").value = "读卡成功";
			document.getElementById("idName").value = CertCtl.Name;
			document.getElementById("idSex").value = CertCtl.Sex;
			document.getElementById("idNation").value = CertCtl.Nation;
			document.getElementById("idBirthday").value = CertCtl.Born;
			document.getElementById("idCertAddr").value = CertCtl.Address;
			document.getElementById("idCertNbr").value = CertCtl.CardNo;
			document.getElementById("idCertDep").value = CertCtl.IssuedAt;
			document.getElementById("idCertEffDate").value = CertCtl.EffectedDate;
			document.getElementById("idCertExpDate").value = CertCtl.ExpiredDate;
			document.getElementById("idVisaNo").value = CertCtl.PassNum;
			document.getElementById("idVisaNum").value = CertCtl.VisaTimes;
			document.getElementById("idCnName").value = CertCtl.CnName;
			document.getElementById("idEnName").value = CertCtl.EnName;
			
    }
	else
	{
		document.getElementById("idResult").value = "false";
		document.getElementById("idResultDesc").value = "读卡失败";
	}
}
</script>
</html>
